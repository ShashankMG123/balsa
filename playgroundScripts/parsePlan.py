result={'Plan': {'Node Type': 'Aggregate', 'Strategy': 'Plain', 'Partial Mode': 'Simple', 'Parallel Aware': False, 'Startup Cost': 4581990.85, 'Total Cost': 4581990.86, 'Plan Rows': 1, 'Plan Width': 64, 'Actual Startup Time': 23902.506, 'Actual Total Time': 23902.701, 'Actual Rows': 1, 'Actual Loops': 1, 'Output': ['min(n.name)', 'min(t.title)'], 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 4580356.93, 'Total Cost': 4581990.85, 'Plan Rows': 1, 'Plan Width': 32, 'Actual Startup Time': 23857.217, 'Actual Total Time': 23902.681, 'Actual Rows': 32, 'Actual Loops': 1, 'Output': ['n.name', 't.title'], 'Inner Unique': True, 'Hash Cond': '(pi.info_type_id = it.id)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 4580342.8, 'Total Cost': 4581976.71, 'Plan Rows': 1, 'Plan Width': 36, 'Actual Startup Time': 23857.128, 'Actual Total Time': 23902.582, 'Actual Rows': 32, 'Actual Loops': 1, 'Output': ['n.name', 'pi.info_type_id', 't.title'], 'Inner Unique': False, 'Hash Cond': '(n.id = an.person_id)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 4497781.1, 'Total Cost': 4499415.0, 'Plan Rows': 1, 'Plan Width': 48, 'Actual Startup Time': 23252.512, 'Actual Total Time': 23297.956, 'Actual Rows': 14, 'Actual Loops': 1, 'Output': ['ci.person_id', 'n.name', 'n.id', 'pi.person_id', 'pi.info_type_id', 't.title'], 'Inner Unique': False, 'Hash Cond': '(n.id = pi.person_id)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 4239643.9, 'Total Cost': 4241236.83, 'Plan Rows': 1024, 'Plan Width': 40, 'Actual Startup Time': 22810.581, 'Actual Total Time': 22856.228, 'Actual Rows': 17559, 'Actual Loops': 1, 'Output': ['ci.person_id', 'n.name', 'n.id', 't.title'], 'Inner Unique': True, 'Hash Cond': '(ci.person_id = n.id)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 4023358.05, 'Total Cost': 4024928.21, 'Plan Rows': 8674, 'Plan Width': 21, 'Actual Startup Time': 21687.103, 'Actual Total Time': 21713.448, 'Actual Rows': 105262, 'Actual Loops': 1, 'Output': ['ci.person_id', 't.title'], 'Inner Unique': False, 'Hash Cond': '(t.id = ci.movie_id)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 127280.32, 'Total Cost': 128806.84, 'Plan Rows': 224, 'Plan Width': 25, 'Actual Startup Time': 1579.369, 'Actual Total Time': 1585.193, 'Actual Rows': 1467, 'Actual Loops': 1, 'Output': ['ml.linked_movie_id', 't.title', 't.id'], 'Inner Unique': True, 'Hash Cond': '(ml.linked_movie_id = t.id)', 'Plans': [{'Node Type': 'Hash Join', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Join Type': 'Inner', 'Startup Cost': 12.75, 'Total Cost': 1534.9, 'Plan Rows': 1666, 'Plan Width': 4, 'Actual Startup Time': 5.87, 'Actual Total Time': 10.266, 'Actual Rows': 5186, 'Actual Loops': 1, 'Output': ['ml.linked_movie_id'], 'Inner Unique': True, 'Hash Cond': '(ml.link_type_id = lt.id)', 'Plans': [{'Node Type': 'Index Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': 'link_type_id_movie_link', 'Relation Name': 'movie_link', 'Schema': 'public', 'Alias': 'ml', 'Startup Cost': 0.29, 'Total Cost': 1425.16, 'Plan Rows': 29997, 'Plan Width': 8, 'Actual Startup Time': 0.039, 'Actual Total Time': 6.62, 'Actual Rows': 29997, 'Actual Loops': 1, 'Output': ['ml.id', 'ml.movie_id', 'ml.linked_movie_id', 'ml.link_type_id']}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 12.45, 'Total Cost': 12.45, 'Plan Rows': 1, 'Plan Width': 4, 'Actual Startup Time': 0.022, 'Actual Total Time': 0.023, 'Actual Rows': 1, 'Actual Loops': 1, 'Output': ['lt.id'], 'Hash Buckets': 1024, 'Original Hash Buckets': 1024, 'Hash Batches': 1, 'Original Hash Batches': 1, 'Peak Memory Usage': 9, 'Plans': [{'Node Type': 'Index Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': 'link_type_pkey', 'Relation Name': 'link_type', 'Schema': 'public', 'Alias': 'lt', 'Startup Cost': 0.14, 'Total Cost': 12.45, 'Plan Rows': 1, 'Plan Width': 4, 'Actual Startup Time': 0.013, 'Actual Total Time': 0.015, 'Actual Rows': 1, 'Actual Loops': 1, 'Output': ['lt.id'], 'Filter': "((lt.link)::text = 'features'::text)", 'Rows Removed by Filter': 17}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 123010.03, 'Total Cost': 123010.03, 'Plan Rows': 340603, 'Plan Width': 21, 'Actual Startup Time': 1571.26, 'Actual Total Time': 1571.26, 'Actual Rows': 340186, 'Actual Loops': 1, 'Output': ['t.title', 't.id'], 'Hash Buckets': 524288, 'Original Hash Buckets': 524288, 'Hash Batches': 1, 'Original Hash Batches': 1, 'Peak Memory Usage': 22393, 'Plans': [{'Node Type': 'Index Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': 'title_pkey', 'Relation Name': 'title', 'Schema': 'public', 'Alias': 't', 'Startup Cost': 0.43, 'Total Cost': 123010.03, 'Plan Rows': 340603, 'Plan Width': 21, 'Actual Startup Time': 0.039, 'Actual Total Time': 1471.506, 'Actual Rows': 340186, 'Actual Loops': 1, 'Output': ['t.title', 't.id'], 'Filter': '((t.production_year >= 1980) AND (t.production_year <= 1995))', 'Rows Removed by Filter': 2188126}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 3442273.22, 'Total Cost': 3442273.22, 'Plan Rows': 36304360, 'Plan Width': 8, 'Actual Startup Time': 19825.723, 'Actual Total Time': 19825.724, 'Actual Rows': 36244344, 'Actual Loops': 1, 'Output': ['ci.person_id', 'ci.movie_id'], 'Hash Buckets': 67108864, 'Original Hash Buckets': 67108864, 'Hash Batches': 1, 'Original Hash Batches': 1, 'Peak Memory Usage': 1940083, 'Plans': [{'Node Type': 'Index Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': 'person_id_cast_info', 'Relation Name': 'cast_info', 'Schema': 'public', 'Alias': 'ci', 'Startup Cost': 0.56, 'Total Cost': 3442273.22, 'Plan Rows': 36304360, 'Plan Width': 8, 'Actual Startup Time': 0.042, 'Actual Total Time': 10139.2, 'Actual Rows': 36244344, 'Actual Loops': 1, 'Output': ['ci.person_id', 'ci.movie_id']}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 210136.94, 'Total Cost': 210136.94, 'Plan Rows': 491913, 'Plan Width': 19, 'Actual Startup Time': 1121.159, 'Actual Total Time': 1121.287, 'Actual Rows': 543291, 'Actual Loops': 1, 'Output': ['n.name', 'n.id'], 'Hash Buckets': 1048576, 'Original Hash Buckets': 524288, 'Hash Batches': 1, 'Original Hash Batches': 1, 'Peak Memory Usage': 36304, 'Plans': [{'Node Type': 'Gather', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1000.43, 'Total Cost': 210136.94, 'Plan Rows': 491913, 'Plan Width': 19, 'Actual Startup Time': 0.367, 'Actual Total Time': 985.336, 'Actual Rows': 543291, 'Actual Loops': 1, 'Output': ['n.name', 'n.id'], 'Workers Planned': 4, 'Workers Launched': 3, 'Single Copy': False, 'Plans': [{'Node Type': 'Index Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Scan Direction': 'Forward', 'Index Name': 'name_pkey', 'Relation Name': 'name', 'Schema': 'public', 'Alias': 'n', 'Startup Cost': 0.43, 'Total Cost': 159945.64, 'Plan Rows': 122978, 'Plan Width': 19, 'Actual Startup Time': 0.071, 'Actual Total Time': 983.615, 'Actual Rows': 135823, 'Actual Loops': 4, 'Output': ['n.name', 'n.id'], 'Filter': "(((n.name_pcode_cf)::text >= 'A'::text) AND ((n.name_pcode_cf)::text <= 'F'::text) AND (((n.gender)::text = 'm'::text) OR (((n.gender)::text = 'f'::text) AND (n.name ~~ 'B%'::text))))", 'Rows Removed by Filter': 906050, 'Workers': [{'Worker Number': 0, 'Actual Startup Time': 0.058, 'Actual Total Time': 1021.517, 'Actual Rows': 201827, 'Actual Loops': 1}, {'Worker Number': 1, 'Actual Startup Time': 0.062, 'Actual Total Time': 1024.179, 'Actual Rows': 153708, 'Actual Loops': 1}, {'Worker Number': 2, 'Actual Startup Time': 0.13, 'Actual Total Time': 1023.79, 'Actual Rows': 152697, 'Actual Loops': 1}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 258136.82, 'Total Cost': 258136.82, 'Plan Rows': 30, 'Plan Width': 8, 'Actual Startup Time': 440.316, 'Actual Total Time': 440.375, 'Actual Rows': 64, 'Actual Loops': 1, 'Output': ['pi.person_id', 'pi.info_type_id'], 'Hash Buckets': 1024, 'Original Hash Buckets': 1024, 'Hash Batches': 1, 'Original Hash Batches': 1, 'Peak Memory Usage': 11, 'Plans': [{'Node Type': 'Gather Merge', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Startup Cost': 1000.49, 'Total Cost': 258136.82, 'Plan Rows': 30, 'Plan Width': 8, 'Actual Startup Time': 117.527, 'Actual Total Time': 440.317, 'Actual Rows': 64, 'Actual Loops': 1, 'Output': ['pi.person_id', 'pi.info_type_id'], 'Workers Planned': 4, 'Workers Launched': 4, 'Plans': [{'Node Type': 'Index Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': True, 'Scan Direction': 'Forward', 'Index Name': 'info_type_id_person_info', 'Relation Name': 'person_info', 'Schema': 'public', 'Alias': 'pi', 'Startup Cost': 0.43, 'Total Cost': 257133.19, 'Plan Rows': 8, 'Plan Width': 8, 'Actual Startup Time': 110.867, 'Actual Total Time': 434.584, 'Actual Rows': 13, 'Actual Loops': 5, 'Output': ['pi.person_id', 'pi.info_type_id'], 'Filter': "(pi.note = 'Volker Boehm'::text)", 'Rows Removed by Filter': 592720, 'Workers': [{'Worker Number': 0, 'Actual Startup Time': 109.108, 'Actual Total Time': 433.675, 'Actual Rows': 17, 'Actual Loops': 1}, {'Worker Number': 1, 'Actual Startup Time': 110.701, 'Actual Total Time': 433.374, 'Actual Rows': 12, 'Actual Loops': 1}, {'Worker Number': 2, 'Actual Startup Time': 109.48, 'Actual Total Time': 433.981, 'Actual Rows': 12, 'Actual Loops': 1}, {'Worker Number': 3, 'Actual Startup Time': 109.839, 'Actual Total Time': 434.092, 'Actual Rows': 10, 'Actual Loops': 1}]}]}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 74272.66, 'Total Cost': 74272.66, 'Plan Rows': 663123, 'Plan Width': 4, 'Actual Startup Time': 598.973, 'Actual Total Time': 598.974, 'Actual Rows': 674692, 'Actual Loops': 1, 'Output': ['an.person_id'], 'Hash Buckets': 1048576, 'Original Hash Buckets': 1048576, 'Hash Batches': 1, 'Original Hash Batches': 1, 'Peak Memory Usage': 31912, 'Plans': [{'Node Type': 'Index Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': 'person_id_aka_name', 'Relation Name': 'aka_name', 'Schema': 'public', 'Alias': 'an', 'Startup Cost': 0.42, 'Total Cost': 74272.66, 'Plan Rows': 663123, 'Plan Width': 4, 'Actual Startup Time': 0.086, 'Actual Total Time': 455.103, 'Actual Rows': 674692, 'Actual Loops': 1, 'Output': ['an.person_id'], 'Filter': "(an.name ~~ '%a%'::text)", 'Rows Removed by Filter': 226651}]}]}, {'Node Type': 'Hash', 'Parent Relationship': 'Inner', 'Parallel Aware': False, 'Startup Cost': 14.12, 'Total Cost': 14.12, 'Plan Rows': 1, 'Plan Width': 4, 'Actual Startup Time': 0.059, 'Actual Total Time': 0.059, 'Actual Rows': 1, 'Actual Loops': 1, 'Output': ['it.id'], 'Hash Buckets': 1024, 'Original Hash Buckets': 1024, 'Hash Batches': 1, 'Original Hash Batches': 1, 'Peak Memory Usage': 9, 'Plans': [{'Node Type': 'Index Scan', 'Parent Relationship': 'Outer', 'Parallel Aware': False, 'Scan Direction': 'Forward', 'Index Name': 'info_type_pkey', 'Relation Name': 'info_type', 'Schema': 'public', 'Alias': 'it', 'Startup Cost': 0.14, 'Total Cost': 14.12, 'Plan Rows': 1, 'Plan Width': 4, 'Actual Startup Time': 0.029, 'Actual Total Time': 0.052, 'Actual Rows': 1, 'Actual Loops': 1, 'Output': ['it.id'], 'Filter': "((it.info)::text = 'mini biography'::text)", 'Rows Removed by Filter': 112}]}]}]}, 'Planning Time': 6.547, 'Triggers': [], 'Execution Time': 23953.038}

def print_plan_with_actual_cost(plan, indent=0):
    # Print the current plan's details
    indent_str = '  ' * indent
    nodeType = plan['Node Type']
    if(len(nodeType.split(" ")) > 1 and nodeType.split(" ")[1] in ["Join", "Scan"]):
        print(f"{indent_str} {nodeType}", end=" ")
        print(f"Actual Total Time: {plan.get('Actual Total Time', 'N/A')}")
        print()

    # Recursively print subplans, if any
    if 'Plans' in plan:
        for subplan in plan['Plans']:
            print_plan_with_actual_cost(subplan, indent + 1)

def main():
    # Extract the main plan from the result
    main_plan = result["Plan"]
    
    print("Execution Plan with Actual Cost:")
    print_plan_with_actual_cost(main_plan)

if __name__ == "__main__":
    main()